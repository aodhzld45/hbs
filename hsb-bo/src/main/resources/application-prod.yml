spring:
  datasource:
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
  mail:
    host: ${MAIL_HOST}
    port: ${MAIL_PORT}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail.smtp.auth: true
      mail.smtp.starttls.enable: true
    default-encoding: UTF-8

file:
  upload-path: ${FILE_UPLOAD_PATH}
jwt:
  secret: ${JWT_SECRET}
  expiration: 3600000
cloud:
  aws:
    credentials:
      access-key: ${AWS_ACCESS_KEY_ID}
      secret-key: ${AWS_SECRET_ACCESS_KEY}
    region:
      static: ${AWS_REGION}

kis:
  domain: ${KIS_DOMAIN:https://openapivts.koreainvestment.com:29443}  # 모의 기본. 실계: https://openapi.koreainvestment.com:9443
  app-key: ${KIS_APP_KEY}
  app-secret: ${KIS_APP_SECRET}
  oauth-path: /oauth2/tokenP # 환경에 따라 다를 수 있음

krx:
  symbols:
    out-path: ${KRX_SYMBOLS_OUT_PATH:/home/hbs/data/krx/symbols.csv}
    cron: "0 5 6 * * *"             # 매일 06:05 KST
    #cron: "0 0/1 * * * *"          # 테스트 1분마다

openai:
  base-url: ${OPEN_AI_DOMAIN}
  api-key: ${OPEN_AI_KEY}
  model: ${OPEN_AI_MODEL}

logging.level.root: INFO
logging.level.org.springframework.web.reactive.function.client: INFO

hsbs:
  brain:
    base-url: ${BRAIN_BASE_URL:http://127.0.0.1:8000}
    api-key: ${BRAIN_API_KEY:change-me}
    enabled: true
    ingest-path: ${BRAIN_INGEST_PATH:/api/brain/kb/ingest}
    timeout-ms: ${BRAIN_TIMEOUT_MS:120000}
  kb:
    job:
      enabled: ${KB_JOB_SCHED_ENABLED:true}

      # adaptive polling
      min-delay-ms: ${KB_JOB_MIN_DELAY_MS:5000}
      max-delay-ms: ${KB_JOB_MAX_DELAY_MS:60000}

      initial-delay-ms: ${KB_JOB_INITIAL_DELAY_MS:3000}

      idle-threshold: ${KB_JOB_IDLE_THRESHOLD:3}       # 연속 3번 유휴면 backoff 적용
      idle-backoff-multiplier: ${KB_JOB_IDLE_BACKOFF_MULTIPLIER:2.0}  # 2배씩 증가
      idle-log-every: ${KB_JOB_IDLE_LOG_EVERY:60}      # 유휴 로그는 N번마다 1번(0이면 끔)